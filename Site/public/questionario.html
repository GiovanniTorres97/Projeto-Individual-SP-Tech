<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" href="assets/icons/Wackypixel-Lesters-Electric-Guitar-Burst-Guitar.ico"
        type="image/x-icon">
    <title>Questionário Musical</title>
</head>

<body>
    <header>
        <div class="container">
            <h1><a href="telaInicial.html">My Life, My Playlist</a></h1>
            <nav>
                <ul>
                    <li><a href="telaInicial.html">Home</a></li>
                    <li><a href="index.html">Sobre Mim</a></li>
                    <li><a href="questionario.html">Questionário</a></li>
                    <li><a href="curiosidades.html">Curiosidades</a></li>
                </ul>
            </nav>
        </div>
    </header>


    <main>
        <div class="divQuestionario">
            <h1>Questionário</h1>
            <form id="questionario">
                <div class="inputsQuestionario">
                    <div class="pergunta">
                        <p>1. Qual gênero de música você mais ouve?</p>
                        <select name="q1">
                            <option value="#"></option>
                            <option value="pop">Pop</option>
                            <option value="rock">Rock</option>
                            <option value="sertanejo">Sertanejo</option>
                            <option value="funk">Funk</option>
                            <option value="mpb">MPB</option>
                            <option value="rap">Rap</option>
                            <option value="samba">Samba</option>
                            <option value="eletronica">Eletrônica</option>
                        </select>
                    </div>

                    <div class="pergunta">
                        <p>2. A música ajuda a melhorar o seu humor?</p>
                        <select name="q2">
                            <option value="#"></option>
                            <option value="sim">Sim</option>
                            <option value="nao">Não</option>
                            <option value="asVezes">Às vezes</option>
                        </select>
                    </div>

                    <div class="pergunta">
                        <p>3. A música te ajuda a lembrar de momentos especiais?</p>
                        <select name="q3">
                            <option value="#"></option>
                            <option value="sim">Sim</option>
                            <option value="nao">Não</option>
                            <option value="asVezes">Às vezes</option>
                        </select>

                    <div class="pergunta">
                        <p>4. Você gosta de música mais para relaxar ou para se animar?</p>
                        <select name="q4">
                            <option value="#"></option>
                            <option value="relaxar">Relaxar</option>
                            <option value="animar">Animar</option>
                            <option value="ambos">Ambos</option>
                        </select>

                    <div class="pergunta">
                        <p>5. Você escuta música para refletir sobre sentimentos ou para lazer?</p>
                        <select name="q5">
                            <option value="#"></option>
                            <option value="refletir">Refletir</option>
                            <option value="lazer">Lazer</option>
                            <option value="ambos">Ambos</option>
                        </select>

                    <div class="pergunta">
                        <p>6.  Numa escala de 1 a 5, qual a intensidade da conexão emocional que a música gera em você? </p>
                        <select name="q6">
                            <option value="#"></option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                        </select>
                    
                        <div class="pergunta">
                            <p>7. A música ajuda a melhorar o seu humor ou a lidar com situações difíceis?</p>
                            <select name="q7">
                                <option value="#"></option>
                                <option value="sim">Sim</option>
                                <option value="nao">Não</option>
                            </select>

                        <div class="pergunta">
                            <p>8. Você já se emocionou ao ouvir uma música?</p>
                            <select name="q8">
                                <option value="#"></option>
                                <option value="sim">Sim</option>
                                <option value="nao">Não</option>
                            </select>
                        
                        <div class="pergunta">
                            <p>9. Você sente que a música influencia sua energia?</p>
                            <select name="q9">
                                <option value="#"></option>
                                <option value="sim">Sim</option>
                                <option value="nao">Não</option>
                            </select>
                </div>
                    <button type="button" onclick="submitQuestionario()" class="botaoLogin">Enviar
                        Respostas
                    </button>
                    <p id="resultado"></p>
            </form>
        </div>
    </main>

    <footer>
        <p>&copy; 2024 My Life, My Playlist. A SPTech School Project</p>
    </footer>

</body>

</html>

<script>
    function submitQuestionario() {
        // Recupera o ID do usuário (pode ser do localStorage ou de uma variável global)
        const idUsuario = localStorage.getItem("idUsuario");

        // Coleta as respostas do formulário
        const respostas = [
            { fkPergunta: 1, resposta: document.querySelector("select[name='q1']").value },
            { fkPergunta: 2, resposta: document.querySelector("select[name='q2']").value },
            { fkPergunta: 3, resposta: document.querySelector("select[name='q3']").value },
            { fkPergunta: 4, resposta: document.querySelector("select[name='q4']").value },
            { fkPergunta: 5, resposta: document.querySelector("select[name='q5']").value },
            { fkPergunta: 6, resposta: document.querySelector("select[name='q6']").value },
            { fkPergunta: 7, resposta: document.querySelector("select[name='q7']").value },
            { fkPergunta: 8, resposta: document.querySelector("select[name='q8']").value },
            { fkPergunta: 9, resposta: document.querySelector("select[name='q9']").value }
        ];

        // Verifica se todas as respostas foram preenchidas
        const respostasPreenchidas = respostas.every(resposta => resposta.resposta !== "#");

        if (!respostasPreenchidas) {
            alert("Por favor, preencha todas as perguntas.");
            return;
        }

        // Envia a requisição POST para salvar as respostas
        fetch("/api/respostas", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                idUsuarioServer: idUsuario,  // ID do usuário
                respostasServer: respostas  // Respostas do questionário
            })
        })
        .then(response => response.json())
        .then(data => {
            console.log("Respostas salvas:", data);
            alert("Respostas enviadas com sucesso!");
        })
        .catch(error => {
            console.error("Erro ao enviar respostas:", error);
        });
    }
</script>
